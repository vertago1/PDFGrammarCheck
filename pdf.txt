WhatconstitutesDNStraffictoday?ChanginglandscapeofDNSAllenT.WebbA.L.NarasimaReddyDept.ofECETexasA&MUniversityDept. of ECE
TexaDept.ofECETexasA&MUniversityallenwebb@tamu.edureddy@ece.tamu.eduABSTRACTlardomain.DNStrafficistypicallyallowedthroughfirewalls;thus,manynewservicesareusingDNSinfras-tructureasameansofcommunicatinginformation.DNStraffichasbeenwidelystudiedtounderstandnetworktrafficatlarge.DNStrafficprovidesaviewintotrafficpatterns[7],populardomains.DNSresponsesgiveaviewintothemechanismsofloadbalancing[29,23]andthefunctioningofContentDistributionNet-works(CDNs)[27].DNStraffichasrecentlybeenusedtoprovideaviewintobotnetbehavior,bydistinguish-ingthebotnetgeneratedDNSquerytrafficfromhumangeneratedquerytraffic[5].CollectingandanalyzingDNStrafficismorescalablethancarryingoutsimilaranalysisontheentirenetworktraffic.Thisstudyismotivatedbytwotrendsinnetworkus-age.Thefirstisthegrowinguseofmobileandwire-lessdevices.Usershavestartedreplacingdesktopcom-puterswithlaptopsandotherdevices;thewidespreadadoptionofsmartphoneswithWi-Ficapabilitiesischang-ingthenetworkusagepatterns.TheintroductionofmobiledevicesbringsseveralaspectstothestudyofDNStraffic.Thenetworktrafficcanbedifferentbe-causeofdifferencesinapplicationusage,networkusage,andthedifferentresourcesinthedevices.Theapplica-tionusageonmobiledevicesmayincludemorefrequentaccessestosocialnetworkingandvideosites.Thewire-lessdevicesonacampusthathaswideWi-Ficoverageallowformorecontinuousorlongerusageofnetworkresourcescomparedtodesktopdevices.Mobiledeviceswithlimitedresources(andhencelowercaching)mayalsogeneratemoretrafficthandesktopdevices.ThesecondtrendistheusageofDNSasasidechan-nelbymanyapplications.Mostcampusandenterprisenetworksareprotectedbyfirewallsattheedge.Thesefirewallsrestricttheflowoftrafficbetweentheprotectednetworkandtheoutsideworld.However,mostnet-workfirewallstypicallyallowcommunicationonafewdesignatedports.TheportsforHTTPandDNSarecommonlyleftopen,andanumberofapplicationshavecometorelyontheseopenportsforgettingthroughthefirewalls.DNSisbeingusedbyanumberofappli-cationsfromspamcheckerstoantivirussoftwareasaNewtechnologyandnewapplicationsaredrivingrapidchangeintheservicesaccessedovertheInternet.TheDomainNameSystem(DNS)isfundamentaltotheday-to-dayoperationoftheInternet.AsnewusesforDNSareintroducedandthewayspeopleusetheInternetchange,theimpactonexist-ingnetworkutilitiesandservicesneedtobecontinuouslystudiedandevaluated.WepresentastudyoftheDNStraf-ficonalargecampusnetworkandinvestigatetheimpactofnewapplicationsofDNS.WestudyvariousaspectsofDNStrafficincludingthenetworksources,applicationsources,andespeciallythevarioussourcesofDNSNXDOMAINre-sponses.Inaddition,welookintothedifferencesinDNStrafficfromwiredhostsandWi-Fihosts.Ourresultsindicatethatnon-negligiblefraction(10-15%)ofDNSqueriesre-sultinNXDOMAINresponses,manynewapplicationshavecometorelyonDNSasasidechannelthroughnetworkfire-wallsandthatwirelessDNStrafficcanexceedthewiredDNStraffic.CategoriesandSubjectDescriptorsC.2.2[Computer-CommunicationNetworks]:Net-workProtocols;C.2.3[Computer-CommunicationNetworks]:NetworkOperationsNetworkmonitor-ing;C.2.5[CommunicationNetworks]:LocalandWide-AreaNetworksInternet;C.4[PerformanceofSystems]:MeasurementstudiesKeywordsDNS,measurementstudy,Wi-Fivs.wired1.INTRODUCTIONTheDomainNameSystem(DNS)[21,22]providesawaytomaphumanreadablenamesintoInternetProto-coladdresswhichcanberoutedtospecificendpointsontheInternet(e.g.www.domain.tld).Itservesasadis-tributeddatabaseforrecordswhichareidentifiedwithamulti-partname.DNSservershaveauthorityoversubsetsofnamesdelegatedtothem.Inthiswaythead-ministrativeburdenofupdatingrecordsisspreadacrosstheorganizationswhichhaveauthorityoveraparticu-1
icu-1
sidechanneltocontactoutsideserverstoprovidetheirservice.OthernewnewservicesweobservedareENUMoverDNS(subsection5.6),andtheICANNnamecol-lisionblocklist.NewserviceswhichmakeuseoftheDomainNameSystem(DNS)infrastructurechangethelandscapeofDNSqueries.ThispaperstudiestheDNStraffictoobserveandunderstandtheimpactofthesetwotrends.WecollectandanalyzeDNStrafficataneducationalinstitutiontounderstandthenatureofnetworktraffic.Abetterun-derstandingofwhatisimpliedbyDNStrafficimprovesdecisionmakingintheareaofhowmuchmonitoringiswarrantedtostopoutbreaksofmalicioussoftwareanddetectintrusionwhileprotectingindividualprivacy.AbetterpictureofDNStrafficwillalsohelpgainanun-derstandingofscalabilityandotherissues.Forexample,DNStraffichasbeenrecentlyusedasameanstoiden-tifybotnetC&C(commandandcontrol)[33],[34],and[3].Specifically,theseearlierstudieshaveusedDNSNXDOMAINresponsesasameansofidentifyingpo-tentialbotnettraffic.ManynewapplicationssuchasspamcheckersandantivirustoolsthatuseDNSasasidechannelgenerateasignificantnumberofNXDO-MAINresponsesaspartoftheirlegitimateservice.Un-derstandingandseparatingthistrafficisimportantforcontinuingtoprovidesecurityofthenetworks.Thepapermakesthefollowingsignificantcontribu-tions:balancingperformancefromusingasingleDNSserverforageographicallydiversesetofmobiledevices.DNShasbeenwidelyusedforloadbalancingandreducingdelaysoverwideareanetworksthroughredirection[29,23].DNShasalsobeenusedasawaytomeasuredelaysacrosstheinternet[18].DNSmeasurementstudieshavebeenconductedinthepastfromthepointofviewofarootDNSserver[7].ThisstudyidentifiedviolationsoftheDNSstandard,reflectionattacks,anddividedupDNSfailureresponsesbythereasonstheyfailed.Domainregistrationhasbeenstudiedforthepossibil-ityofidentifyingspammersearlyin[12].DNSbehaviorhasbeenstudiedfromseveralvantagestounderstandtheglobalDNSquerypatternswhichcanbeusedtodetectmaliciousdomaingroups[10].DNStraffichasrecentlybeenusedtoprovideaviewintobotnetbehavior,bydistinguishingthebotnetgen-eratedDNSquerytrafficfromhumangeneratedquerytraffic.In[31],[33],[34],and[3]non-existentdomainqueriesareusedtoidentifybotnetswhichusedomaingenerationalgorithms(DGA)forlocatingtheC&Cchan-nel.Thequeryratesforbotswereobservedtobehigh,occurringoverashortperiodoftime,andgeneratingNXDOMAINresponsesin[31].DNSerrorresponseswereclassifiedusingthetypeoferror,queryentropyoverthenumberofrequestsperlocalresolverandau-thoritativenameserver,andquerycontentin[16].Theyfoundastringofmaliciousdomainscopyingstringsfromcommonsocialnetworkdomains.In[2]and[5]ratherthanfocusingonDGA,aclassificationschemeisdevel-opedformaliciousdomains.[5]makesuseoftiminginformation,addressrecordIPrelatedinformation,re-verserecordinformation,TTLstatistics,anddomainnamefeaturestoperformtheclassification.ThepossibilityofinformationbeingleakedthroughDNSisinvestigatedin[26].Theyemployseverallayersoffilteringtoidentifyinterestingtraffictobeinvesti-gated.TheirfinaldetectionisbasedonaboundonhowmuchinformationmaybeconveyedthroughthecontentsandtimingofDNStrafficafterfiltering.Sev-eralservicesnowuseDNSforpurposesbeyondlookinguptheaddressrecordofaserverbyname.WepresentanexhaustivesurveyofDNStraffictoidentifynewar-easofusage.Inadditiontointentionalleakageofinformation,thearchitectureofanetworkcanbeinferredthroughDNStraffic.TheproblemofremotelyidentifyingthetypeofDNSclientinfrastructureisaddressedin[28].TheydistinguishDNSclientsintoopenDNSserverswhichareforwarders,orrecursiveresolvers,directrecursiveresolvers,andhiddenDNSservers.TheyperformthisclassificationbyprobingforDNSserversbyissuingre-queststoanauthoritativenameservertheycontrol.DNStrafficcanbeanalyzedtoidentifytheoperat-ingsystemsofhosts.DNSquerytraffichasbeenem-CollectsandanalyzestheDNStrafficoverseveraldaysatacampusnetwork,separatingthetrafficfromwirednetworksandwirelessnetworks.Showsthatwirelessnetworksarestartingtodomi-natethecampustraffic,leadingtoimplicationsonscalabilityandthroughputofthesenetworks.ShowsthatasignificantfractionofDNStrafficre-sultsinfailures,muchofthistrafficoriginatingfromnewservicesexploitingDNSasasidechan-nel.Theseincreasedfailuretrafficincreasetheprocessingburdenforseparatinglegitimatetrafficfrommalicioustraffic.Showsthattheapplicationusageacrosswirelessandwirednetworksleadstodifferentnetworkac-cesses.2.RELATEDWORKDNStraffichasbeenwidelystudiedtounderstandnetworktrafficatlarge.DNStrafficprovidesaviewintotrafficpatterns[7],populardomainsandthroughresponsesaviewintothemechanismsofloadbalanc-ing[29,23]andthefunctioningofContentDistributionNetworks(CDNs)[27].DNStrafficincellularnetworkshasbeenrecentlystudied[27].TheyinvestigatetheimpactonCDNload2
tonCDNload2
Dataset1Dataset2TimePeriodSummerFallSemesterStartDateDuration(days)TotalRequests%NoError%ErrorTotalUnique%ResolvedDomains%NotRes.TotalUniqueIPs%Wired%Wi-FiJune 19, 2014
13.07
2.02E+09
70.11%
29.89%
9.22E+06
47.10%
52.90%
1.77E+05
42.96%June19,201413.072.02E+0970.11%29.89%9.22E+0647.10%52.90%1.77E+0542.96%57.04%Sep. 9, 2014
10.26
2.57E+09
92.02%
7.43%
9.08E+06
57.72%
42.28%
1.66E+05
29.63%Sep.9,201410.262.57E+0992.02%7.43%9.08E+0657.72%42.28%1.66E+0529.63%70.37%Dataset3SpringSem.WeekendJan.16,20152.262.36E+0886.35%13.00%1.08E+0676.67%23.33%9.65E+0424.74%75.26%Dataset4SpringSem.WeekJan.22,20157.021.82E+0991.10%7.99%4.81E+0676.66%23.34%1.78E+0526.59%73.41%Table1:Volumeoftrafficpresentineachdatasets.ItshouldbenotedthatforbothDataset1andDataset3andweekenddatasettherearefewerstudentsoncampusthantheotherdatasets.Thisprovidesavarietyofdifferentconditionstoobservetheuniqueandcommonfeaturesacrossthedatasets.domain,.Thesemadeup0.05%to0.18%ofthetotalrequests.ItisnotablethatinTable1between7.43%and29.89%oftheDNSrequestsfailedacrossthedatasets.TheDNSfailurerateswerehigherduringthesummerandweek-ends.ThehostswhichfilteroutSpamemailsgener-ateahigherratiooffailedtosuccessfulDNSresponsesthantypicalusers.Whentherearemoretypicaluserssuchastheuniversitystudentsduringthesemesterorweek,therelativecontributionoftheSpamfiltertraf-ficisless.Indataset1thehostswhichaccessedSpamblacklistshada50.7%DNSerrorrateandwererespon-siblefor37.5%ofthetotalDNSresponses.Intheotherdatasetsthesehostswereresponsiblefor13-18%oftheDNSresponses.Wefoundthatfourforwardingname-serverswereresponsibleforthemuchlargernonexistentdomainpercentageindataset1.Fordatasets2and4theerrorratesofhostsaccessingSpamblacklistswerebetween16.4%and19.0%,whilefordataset3theerrorratewas29.4%.Thehighererrorratefordataset3islikelyduetothevolumeofDNSerrorsremainingrel-ativelyflatacrosstheweekwhilethesuccessfultrafficismoredependentonthetimeofdayanddayoftheweek,seeFigure4.Alsoofnote,isthedifferenceinpercentagesofdo-mainswhichresolvedversusdomainswhichdidnotre-solve.Domainswhichresolvedhadatleastonesuccess-fulDNSresponsewhiledomainswhichdidntresolvehadnosuccessfulDNSresponses.Therewereahigherpercentage,70.11%to92.02%,ofsuccessfulDNSre-sponsesthanresolveddomains,47.10%to76.66%.TheuniqueIPsinTable1showthechangeinrelativepercentageofIPaddressesbetweenthewiredandWi-FinetworksduringthesummerwhenstudentswereawayployedtocarryoutpassiveOSfingerprintingin[20]us-ingOS-specificDNSqueriesandtimingofDNSqueries.Theyalsoestimatedthenumberofdevicesgeneratingthequeries.WorkhasbeendonetoevaluatetheperformanceofDNScachesin[15].IntheirstudyDNStrafficwascol-lectedalongwithTCPSYN,FIN,andRSTpackets.TheyinvestigatedtherelationshipbetweenTTLandDNScachehitrateandfoundthatmostoftheDNScachehitsoccurwithinminutesoftheinitialmiss.Otherworkhasinvestigatedthedifferenceinusagepatternsbetweentraditionalcomputerssuchasdesk-topsandmobiledevices[9].Thisworkmakesnomen-tionofDNSbutinsteadreliesonothermeasurements.Ourworkseekstogaininsightsintomobiledeviceusagewithonlyasubsetofthenetworktraffic.3.DATASETS/METHODSOurmeasurementsweretakenfromacampusofabout60,000users.WecollectedalltheDNStrafficfromfourtimeperiods:oneduringthesummerof2014,andoneduringthefallsemesterof2014,andtwoduringthespringsemesterof2015.OurdataincludesrequestsforwhichthecampusDNSserversarethestartofauthor-ity(SOA)andalsolocalquerieswhichwererecursivelyresolved.Thesizeofthedatasetsandsomebasicstatis-ticsabouttheirconstituentscanbefoundinTable1.TocollectourdatawetappedDNStrafficdirectedtothecampusDNSresolvers.WeexcludedtrafficinvolvedintheprocessofrecursiveDNSresolution.Thus,eachdatasetcontainsthoseDNSrequestsmadetothelocalcampusresolvers,aswellasthecorrespondingresponsesfromtheresolverbacktotherequester.Thesetraceswerethenprocessedafterward.DNSnameslongerthanthe255bytelimitareincludedinthecountasanempty3
anempty3
Figure1:CDFofDNSAddressRecordTTLValuesFigure3:VolumeofDNSRequestsforeachDomainleveldomainshadmoresuccessfulDNSrequestsfromwiredhostsandtheseaccountedfor1.70%ofallthesuc-cessfulDNSrequests.ThisshowsthatasmallsubsetofdomainsareresponsibleforasignificantbiasintheamountofsuccessfulDNSqueriesbetweenwiredandWi-Fidevices.InTable2thetop50mostrequestedsecondleveldo-mainsarelisted.Onlysuccessfulrequestsarecountedinthistable.The%AllcolumnisthepercentageofallsuccessfulDNSrequestswhichmatchthespecifiedsec-ondleveldomain.TheWi-Fi%columnisthefractionofsuccessfulDNSrequestsforthespecifiedsecondleveldomainwhichoriginatefromWi-FiIPaddresses.TheRankcolumnshowstherankofthatdomaininthetop500Alexalist.TheTimetoLive(TTL)valueofaDNSrecordcon-veyshowlongtherecordshouldbecachedbeforeex-piring.MoreinformationcanbeinferredfromtheTTLvaluesastheyreflectatradeoffbetweenDNSserverloadandupdateresponsetime.ArecordwithahigherTTLiscachedlongerandisrequestedlessfrequentlyasaresult.Webserviceswhichdependheavilyonloadbalancingtoprovidebetterquality-of-servicesuchasvideostreamingusesmallTTLstoallowforfastercon-troloverwhichserversreceivenewclients.Contentdis-tributionnetworks(CDN)alsousesmallTTLvalues.Fast-fluxingDNSbotnetsusesmallTTLvaluestomakeitmoredifficulttoblacklistalltheirIPaddressesanddomainnames.TheTTLvaluesfordifferentsubsetsofdomainsgroupedbyAlexarankareshowninFigure1.Morethan80%ofthedomainsranked51stthrough500thhadTTLval-uesof60secondsorless.Forthetop50domainsalmosthalfoftherequestshadTTLvaluesbetween60secondsand5minutes.TheremainingdomainshadmoreofaspreadoverthedifferentTTLvalueswithabouthalfhavingTTLvalues60secondsorless.Figure1showstheCDFoftheTTLvaluesofaddressrecordsforWi-Fiandwireddevices.WesawthatmoreoftheTTLFigure2:CDFofDNSRecordTTLsGroupedbyAlexaRankversusduringthesemesterswhenstudentswerepresent.Betweendatasets1and2thisdifferencewas13.33%.4.WIREDVS.WI-FIDNSTRAFFICTheavailabilityoflowcostandportablecomputerssuchaslaptops,smartphones,andtabletshasintro-ducednewvariationintothewaynetworksareused.OnewindowforobservingchangesinusageistheDNSrequestsmadebydifferentclassesofdevices.Alexaisananalyticscompanywhichprovidesrank-ingsforthemostpopularwebsitesontheInternet[1].WecomparedtherankingofdomainsonAlexawiththerankingofdomainsbyvolumeofDNSrequestsandprovideasummaryhere:Thetop50domainsonAlexawereresponsiblefor34.69%ofthesuccessfulrequestsfromWi-FiIPsand16.59%onwiredIPs.Thetop500domainsonAlexawereresponsiblefor48.63%ofthesuccessfulrequestsfromWi-FiIPsand27.01%onwiredIPs.Ofthetop500domainsonAlexa:Foursec-ondleveldomainswereresponsiblefor21.93%ofallthesuccessfulDNSrequests,andofthese83.30%ofthere-questsoriginatedfromWi-FiIPaddresses.97second4
80606040402020005942571233452740939838076.74%
78.86%
76.14%
62.16%
72.94%
91.15%
73.41%
81.55%
79.30%
43.60%
100
1.22%
1.01%
0.92%
0.73%
0.73%
0.69%
0.65%
0.62%
0.62%
0.61%
100
Rank
46
1
2
130
288
31
4
480
9
495
47
25
361
94
Wi-Fi %
92.77%
73.22%
85.52%76.74%78.86%76.14%62.16%72.94%91.15%73.41%81.55%79.30%43.60%1001.22%1.01%0.92%0.73%0.73%0.69%0.65%0.62%0.62%0.61%100Rank46121302883144809495472536194Wi-Fi%92.77%73.22%85.52%77.69%79.39%94.79%74.65%89.89%77.25%82.32%48.11%86.59%65.94%68.81%% All
20.76%
18.49%
8.48%
5.15%
4.96%
4.57%
3.18%
2.96%
2.79%
1.83%
1.78%
1.54%
1.33%%All20.76%18.49%8.48%5.15%4.96%4.57%3.18%2.96%2.79%1.83%1.78%1.54%1.33%1.29%2ndLevelDomainapple.comgoogle.comfacebook.comamazonaws.comakamaihd.netinstagram.comyahoo.comicloud.comtwitter.comgoogleapis.commicrosoft.combing.comcloudfront.netgoogleusercontent.comnetflix.comfbcdn.netamazon.comlive.comyoutube.comspotify.commsn.comtwimg.comtumblr.comdropbox.comOperatingSystemsBrowsersFigure5:PercentofTotalDNSRequestsfromWi-FihostsforSoftwareSpecificDomainNames(Dataset4)Figure4showsthenumberofDNSresponseswithandwithouterrorsperfiveminuteinterval.ThedatashowedadifferentdiurnalcycleforwiredversuswirelessespeciallyforDNSerrorresponses.ThedifferenceindiurnalcycleislikelyduetotheWi-Fidevicesbeingusedafterworkhoursforpersonaluse,butthewireddevicesweremostlyaccessedduringworkhours.Inatypicalday,thewiredhostsseeadrop-offinactivityafter5-6PMandthewirelesshostswereactiveuntil10-11PM.ThevolumeofDNSerrorsforWi-FihostsmorecloselyfollowsthevolumeofDNSsuccesses.TherelativelyflaterrorresponsevolumeforwiredhostsinFigure4isduetotherequestsfromSpamfilterswhicharerelatedtothevolumeofemailtraffic.TheWi-Fihostsarerespon-sibleformoresuccessfulDNSresponsesthanthewiredhosts,buttheWi-Fihostsproducelessfailedresponsesthanthewiredhosts.ThespikesinWi-Fierrorre-sponsesonFigure4resultfromanomaloustrafficwhichisdiscussedinsubsection5.7.OneinterestingfeatureinFigure4iscentered4.5daysafterthestartofthetrace.TherewasafootballgameduringthistimewhichresultedinlessthanhalftheWi-FiDNSresponsesoneachsideofthevalley.TheDNSresponsesfromwiredhostsdidnothaveanoticeablechangeinthevolume.Itispossibletopredictwhenstudentsarebetweenclassesbychangesinthevolumeoftraffic.ThereareregularpeaksontheWi-FiDNSresponseswithouter-rorsinFigure4duringthebreaksbetweenclasses.Figure5showsthepercentagesofDNSrequestsmadeforsoftwarespecificdomainnames.Theparticulardo-mainchosenwherethoseusedforsoftwareupdatesandTable2:MostRequestedSecondLevelDomainsfromAlexaTop500valuesofDNSaddressrecordsrequestedbyWi-Fide-vicesweresixtysecondsorlessthan5minutes.OthercommonTTLvaluesincludethreehoursandoneday.ThissuggeststhatusersofWi-FidevicesrequestedmoreCDNhostedcontentsuchasonlinevideosthanusersofwireddevices.Thefirsttwosecondleveldomains,apple.comandgoogle.com,bothmakeupaverylargepercentageoftheDNStraffic.Thiscanbeexplainedbysynchroniza-tionorothermobiledevicefeaturesondevicesrunningiOSandAndroid.Also,smallTTLvaluesintroducepositivebiasforthenumberofDNSrequestsadomainwillreceive;domainswithlargerTTLvalueswillbecachedlongerandhavefewerrequeststhandomainswithsmallerTTLvalues.InTable2only,microsoft.comanddropbox.com,havemoreDNSrequestsfromwiredhoststhanWi-Fihosts.Figure3showsthatthevolumeofrequestsofdomainsisnearlylinearonalog-logplot.Thisresemblesadis-tributionfollowingapowerlaw[15].However,thereisaslightcurvewhichsuggeststhatitisactuallyapowerlawwithexponentialcutofforalog-normaldistribution.Thedistributionofrequestsfromwireddevicesismorelinearonthelog-logplotthanfromWi-Fidevices.5
32Wi-FiErrorWiredError11010410510WiredNoError10Wi-FiNoError6107ResponsesResponsesResponsesResponsesResponsesResponsesResponsesResponsesResponses10DaysFromStartofCapture(5-minutebins)Figure4:Wiredvs.Wi-FiDNSResponseVolume.muchnowthatsmartphonescanhandleHTMLwhichhaslooserprogrammingrequirementsbutrequiresmoreprocessingpower.accountsynchronization.Anexamplesoftwarespecificdomainisandroid.clients.google.comwhichisusedbyandroidtodownloadapplicationupdatesandtoaccesstheGooglePlayAPI.AsexpectedAndroidandiOSDNSrequestspredominatelyoriginatedfromWi-FiIPaddresses.ThereisastrongbiastowardmobiletrafficoriginatingfromWi-FiIPs,sobyobservingtheWi-Fitendencieswecaninfermobileusagetrends.WindowswassplitaboutevenlybetweentheWi-FiandwiredIPaddresses;however,MacOShadahighernumberofre-questsfromWi-FiIPaddresses.SafariiscloselytiedtoiOSandMacOSsoitspercentageliedbetweenthetwooperatingsystems.RequestsfromFirefoxweremorecommonfromwiredhosts;requestsfromChromewasmorecommononWi-Fihosts.Thesepercentagesarefromtherawtotalnumberofrequests.Mobiledevicessuchassmart-phonesandtabletsareincreasinglycommon.ThesedevicestypicallyconnecttolocalnetworksthroughWi-Fi.Separatewebsitesareprovidedforthesedevicesbecausetheyhavetouchscreensinsteadofamouseandkeyboard.Also,theirscreensmaybemuchsmallersothatadifferentlayoutispreferablethanfordesktopsorlaptops.Domainsofthefollowingformatsareassociatedwithmobiledevices:xhtml.*subdomainusedforanxhtmlmobilesitewhichisbothHTMLandXMLcompliantrequir-inglessprocessingpower.Theapi.subdomainsmadeupthelargestpercentageoftheresponseswithnoerrorwithbetween0.61%and1.19%forwiredhostsandbetween2.46%and5.71%forWi-Fihosts.Althoughwedidobserverequestsmadetotheothermobilerelateddomains,thesemadeuplessthan0.005%ofthetotalrequests.api.*m.*mobile.**.mobiDatasetWi-FiWiredWi-FiWiredWi-FiWiredWi-FiWired12.46%0.61%0.42%0.26%0.12%0.03%0.11%0.01%23.63%1.19%0.38%0.29%0.18%0.06%0.18%0.03%34.68%0.64%0.34%0.18%0.22%0.03%0.17%0.01%45.71%1.02%0.30%0.24%0.21%0.05%0.18%0.02%Table3:SuccessfulMobileRelatedDNSResponses*.mobiTLDdedicatedtomobilewebsitesapi.*subdomainfrequentlyusedforwebandmo-bileapplicationprogramminginterfaceTable3showsthatthemobilehandsetsarenotnec-essarilyalwaysvisitingmobiledomains.Theapi.*do-maingroupiscommonlyusedwithmobileapplicationsinsteadofwebsitesinabrowser.Notallmobileweb-sitesusemobiledomains;somesharethesamedomainasthewebsiteformattedfordesktops.Also,manyweb-sitesaredesignedusingaresponsivedesign[19]whichissharedacrossdifferentdevicesandscreenformats.Althoughtherearestillhitsforolderstylemobiledo-mainssuchaspalm.*,pda.*,wap.*,andxhtml.*,thesem.*,mini.*,andmobile.*subdomainsusedforwebsitesformatedformobiledevices.palm.*,pda.*subdomainsusedtohostwebsitesformattedforpersonaldigitalassistantsorPal-mOSdevices.wap.*,wireless.*subdomainsusedforawirelessapplicationprotocolbrowser.Thisisnotusedas6
rowser.Thisisnotusedas6
101010101010-7Total-8ARPADNS-SDSpamAVWPADBugsTLD-9-10-11Wired12.24%SuccessesFailures3.06%2.01%0.23%2.47%0.81%1.30%0.28%0.63%0.00%0.77%0.01%0.42%0.01%0.25%Wi-FiSuccesses0.34%0.03%0.07%0.10%0.00%0.01%0.01%2.22%Failures0.18%0.55%0.07%0.03%0.07%0.13%0.59%Table4:DifferentSourcesofDNSTrafficWi-Fi-125.CLASSESOFDNSTRAFFICWiredThispaperlooksattheconsiderablenumberofDNSqueryfailuresinordertounderstandthesourceofthesefailures.ThesourceoffailureshavebeencharacterizedintodifferentgroupsasshowninFigure7.InthisfigureAverageInter-packetArrivalTime(seconds)eachclassoftraffic,representedbyacolor,sumsupto100%.Tokeepthecategoriesmutuallyexclusivepack-etswereassignedtothefirstcategorytheymatchedac-Figure6:DistributionofAverageDelayBetweenDNScordingtotheorderBugs,SD,WPAD,INTERN.,LAN,RequestsARPA,SPAM,AV,TLD.ThesearedescriptionsofeachcategorylistedindescendingorderbythepercentageofDNSerrorresponses:domainsmakeupaverysmallpercentageofthetotalLANincludesDNSrequestsfordomainsreservedresponses.orcommonlyusedforlocalnetworkssuchas.lan,Besidesdifferencesinthedomainsbeingqueried,there.local,.localdomain,etc.Seesubsection5.1.werealsoratedifferencesbetweenwiredandWi-Fihosts.ececAvWeobservedhigherDNSpacketratesonwiredhostsvsWi-Fihostsbasedsessionsdefinedbya15minutesep-arationbetweenpacketsforagivenIPaddressshowninFigure6.Toexcludethebiasintroducedbytheedgeofthesessionwindowwecalculatedthemeantimebe-tweenpacketstobethethetimeofthelastpacketminusthetimetothefirstpacketdividedbythetotalnum-berofpacketsminusone.Wi-FiIPaddresseshadahigherlikelihoodoflongperiodsoftimebetweenDNSrequeststhanwiredIPaddresses.Wi-Fidevicesmaybeusedmoreintermittentlythanwireddevices.WiredIPaddresseswithmultiplesimultaneoushoststhroughNAT,andhigherdemandfromDNSdependentservicessuchasSpamfilteringcontributetothehigherrateonwiredIPaddresses.Table4showsthepercentagesofrequestslinkedtoapplicationsotherthangettingtheIPaddressesofserversbycategory.AlthoughARPAisanexistinguseofDNS,itsuseinverificationforSpamfilteringisnotable.DNSbasedblacklistshavebeencreatedforfilteringSpamandidentifyingvirusesforanti-virustools(AV).WPADusesDNStolocateawebproxyautodiscoveryscript.In-validDNSnameshavebeenregisteredasaworkaroundforapplicationbugs.Randomtopleveldomains(TLD)arebeingusedtodetectDNShijacking.SD,ServiceDiscovery,iscomprisedofanydomainlookupwithonedomainlevelstartingwithanun-derscore,[8].ThesedomainsareusedintheDNSservicediscoveryapplicationoftheDNSprotocol.Seesubsection5.2.Intern.denotesDNStrafficforwhichthestartofauthority(SOA)isinternaltothenetworkorbelongstothesameorganizationasthenetwork.Amoregeneraldescriptionofthiscategoryistheinternaldomainsonabusiness,organization,orcampusnetwork.Seesubsection5.1.ARPA,AddressandRoutingParameterArea[13],includesreverseIPlookupsprovidingaDNSnamerecord.ADNSlookuptothenamereturnedbythisrecordshouldbutdoesnotnecessarilymatchtheIPaddresswiththereverselookup.ItalsoincludesotherARPAservicessuchaslookupsforE.164numbersusinge164.arpa.Seesubsection5.3.SpamandAVincludesDNStrafficforblacklistsandwhitelistsusedbySpamfiltersandanti-virussoftware.SpamblacklistsincludethoseforIPad-dressesfromwhichSpamoriginates,unregisteredIPaddresses(bogons),andURIs(uniformresource7
iformresource7
n.ertn.
er
t
In.
er
t
InLABugsii-FWAVWiredRequestsrrorNoEErrorResponsesSpamWi-FiPAARNTLDARPAARPA
SRPA
SpPA
SpaA
SpamSpam
Apam
AVSusBSus
Buus
BuBu p.p.
gp.
gsdireWNIntern.LN
Inte
rn.
L(a)TotalRequests(b)DNSFailuresFigure7:DNSTrafficVolumebyDomainCategoryOtherlookupswhichdonotfitintothepreced-ingcategoriesarediscussedinsubsection5.7.ItisnotedthatDNSqueryfailuresseemtobetheresultofsomevalidservicessuchas(spamchecks,antivirussoftware),softwareandprotocolbugs,alongwithmaliciousandsuspicioustraffic.Within-creaseduseofDNSasamechanismtogetthroughfirewallsforprovidingservices,theDNSfailuretrafficneedstobefilteredappropriatelytoidentifyorisolatesuspiciousandmalicioustraffic.FilteredtrafficshouldbeselectedsothatitshouldnotbeeasyfortheauthorsofmalicioussoftwaretohidetheirC&Ctrafficbyitbeingfilteredinthisstep.identifiers)commonlyincludedinSpam.OftenDNStrafficisallowedthroughfirewallsallowinganti-virusappswithawaytocheckfilehasheson-line.Seesubsection5.4.TLD,topleveldomains,arethosedomainswhichonlyhaveonedomainlevelsuchaslocalhost.Ran-domizedTLDrequestsareusedbysomebrowserstodetectDNShijackingbyISPs(Internetserviceproviders).Seesubsection5.5.WPAD,WebProxyAuto-Discoveryprotocol[24],requestsaremadetoeitherthewpadtopleveldomainorthedomainamachinebelongstowithwpadasthelastleveldomain.Seesubsection5.2.(e.g.wpad.mydomain.tld).InrevisitingtheDNSusagelandscapethesedatasetscontainsomefamiliarcategoriesoftraffic.Thispapercategorizestrafficasbeingfromblacklistsorwhitelists,reverselookups,lookupsfortopleveldomains,lookupsforWPADdomains,lookupsfordomainswhichourDNSserversistheSOAfor,localdomains,andallotherDNSlookups.ThesecategorieswereselectedbyseekingtoexplainthebulkofDNSlookupfailuresandinves-tigateanydistinguishingcharacteristicstoprovidein-sightintodistinctionsbetweenDNStrafficfrommobiledevicesvsservers,desktops,laptopsandotherdeviceswiredintothenetwork.Therewerealsogroupsofrandomdomainswhichsharedsomedomainlevelsandhadbothvalidandnonex-istentdomainresponses.In[33]domainsofthistypewerelinkedtobotnetcommandandcontrol(C&C)traf-fic.Thenewtraceswecollectedhaddomainsthatmatchedthisprofilebuthadvaliduses.BlacklistandBugsrepresentsDNSrequeststhatareeitherin-validorhaveclearindicatorsthattheyresultedfromanapplicationbugormisconfiguration.Forexamplemanyoftheselookupscontainedanen-tireURIorpartsofaURIsuchasprotocol(e.g.http://),port(:80),path(/index.html).TherewereDNSrequestsfordomainnamesofthesameformasvalidIPv4andIPv6addresses.Somere-sembledfilepathsandorterminatedwithcom-monfileextensions.Otherscontainednull,orun-definedwhichsuggestsasoftwareerrorsuchasconcatenatinganullorundefinedJavaScriptvari-abletoaURIwhichthenisinterpretedaspartofthedomain.Othershadinvalidcharacters,spaces,orURL(uniformresourcelocator)encodings(e.g.%20).Seesubsection5.5.8
%20).Seesubsection5.5.8
whitelistservicesarehostedusingtheDNSinfrastruc-tureandarediscussedinalatersection.5.1niqueforenumeratingtheservicesavailableonanet-worksuchasprinters,mediaservers,otherhosts,etc.Itexpandsthecapabilitiesofzeroconfigurationnetwork-ingbeyondIPaddressallocationandhostresolutiontoincludeadvertisingandqueryingservicesonanetwork.WellknownimplementationsofDNS-SDincludeBon-jour,andAvahi.Examplesofautoconfigurationdomainswesawin-cluderequestsforActiveDirectory,andWPAD.ActiveDirectoryusesdomainswithadasthelastleveldomain,(i.e.ad.domain.tld).ItmakesuseofKerberosandLDAP.Non-existentdomainresponsesforActiveDi-rectorydomainspointoutamisconfigurationorserviceoutage.Weobservedthatonly0.14%ofad.*domainrequestsfailed.Identifyingthesecanhelpremovepo-tentialabuseofanymisconfigurationbysomeonetryingtocompromiseanActiveDirectoryclient.Thepercent-agesofauto-configurationtraffic,outofalltheDNSerrorresponsesacrosseachofthefourdatasets,werecomparablebetweenthesetofwiredhostsandthesetofWi-Fihosts.TrafficfortheWebProxyAuto-Discovery[24]pro-tocol(WPAD)madeupbetween1.07%and3.96%ofthetotalDNSerrorsforeachdataset.AlltheDNSresponsesinthedatasetsforWPADdomainswerefail-ures.WPADallowsnetworkadministratorstodistributeaProxyAutoConfig(PAC)file,usuallyInternalandLocalDomainsInternalandlocaldomainsaredomainswhosestartofauthorityislocalorthatbelongtothesameorgani-zationasthenetwork.Thisgroupoftrafficwassingledoutin[26]toremoveDNStrafficwhichwasnotlikelytobeachannelforsomeonetryingtogetinformationthroughthefirewall.Althoughtrafficbetweenbotsmaybelocal,C&Cchannelsrequireinformationfromout-sidethenetwork,sowehighlightthisasitsowncategoryofDNStraffic.Forallfourdatasetsthenumberoferrorresponsesfordomainsassociatedwithlocalnetworkssuchas.lan,.local,and.localdomainwaslowforwiredhosts0.40%,0.71%,0.76%and1.79%.ForWi-Fihoststherewasmuchmorevariation:0.80%,6.09%,47.37%,and45.65%.NoticethatforWi-Fihostsindatasets3and4theseresponsesareamuchlargerpercentage.Theactualvol-umeofresponseswasabout2.04millionforDataset2,butforDataset3was20.6million.Thesedatasetsweretakenoveraboutthesameamountoftimeandbothwhenclasseswereinsession.WhatisdifferentinthiscategoryfromthefirsttwodatasetsfromthesecondtwoisthattherearealargenumberofrequestsfromWi-FiIPaddressesforthedomainlocal.ThereareresponseswithouttheerrorflagsetinthelaterdatasetsbutnoIPaddressisprovidedintheanswerssectionforlocal.TherewasadrasticdifferenceinthenumberofqueriesforthedomainlocalfromWi-Fihosts.MacOSXissuesSOAqueriesforlocalaspartofBonjour[4].Ubuntuissuesthesequeriesaswell,butWindowsdoesnotbydefault.OftheinternalDNSfailuresfromwiredhosts12.95%to33.49%oftheinternaldomainfailureswererepeatedquerieswhichappendedthehostsdomaintoafailedTLDquery.ForWi-Fihoststhisnumberwasfrom0.53%to1.94%.ForexampleiftheGoogleChromebrowserquerieslacxspgdzeandthehostbelongstodo-main.tldoncethefirstqueryfailsanotherquerywillbeissuedforlacxspgdze.domain.tld.Thesefailurescanbeexplainedbyhostsappendingthedomaintheyarecon-figuredtobelongtofailedTLDqueriesandretrying.Insomecasesthereweremorethanoneparentdomainas-sociatedwithasingleIPaddress.ThiscanbeexplainedbydifferentvirtualorphysicalmachinesconfiguredwithdifferentdomainsusingNATandthesameIPaddress.5.2http://wpad/wpad.datwhichdefinesaJavaScriptfunctionFindProxyForURL(url,host).Thisprotocolalsocheckseachlevelofthedomaintreewhichthehostmachinebelongstoinor-dertoautomaticallydeterminetheproxysettings.At-tackerscanuseWPADtoenableman-in-the-middleat-tacks[25].DNS-SDtrafficrangedfrom4.09%to17.61%ofthetotalDNSerrorresponses,butonly0.11%to0.36%ofthesuccessfulresponses.TherewerealsoDNS-SDquerieswhichincludednon-printablecharacters.Uni-codenamesbeingusedorexploitscancausethisbehav-ior.DNS-SDisusedtoenumerateservices.WhenDNS-SDrequestsareissuedthroughnormal(asopposedtomulticast)DNS,itisexpectedthattheserequestswouldfailunlessthelocalDNSserverisconfiguredtolisttheseservices.5.3ARPAAlthoughthe.arpatopleveldomainoriginallywasrelatedtotheARPANETcreatedbyDARPAitnowhasbeenrepurposedtobeAddressandRoutingParameterAreaDomain[13].ThistopleveldomainnowprovidesreverseaddressresolutionnamerecordsforIPv4andIPv6addresses.AnIPversion4lookupfor127.0.0.1wouldhavetheform,1.0.0.127.in-addr.arpa.Theresultisanamerecordwiththevaluelocalhost.NoticethatAuto-configurationDomainsandDNSSer-viceDiscoveryAuto-configurationdomainsforwhichDNSrecordsareusedeithertopointtoanautoconfigurationserverorcontainarecordcontainingtheconfigurationinfor-mation.DNSservicediscovery(DNS-SD)isatech-9
ery(DNS-SD)isatech-9
theorderoftheoctetsisreversedsothatauthoritycanbedelegatedbydomainlevel.Thewiredhostshadbetween12.67%and28.98%.arpaDNSerrorresponsesacrossallthedatasets,andtheWi-Fihostshadbetween3.90%and6.15%.Wein-cludedlookupstothedeprecatedip6.intdomain[14]incountingthe.arpatraffic.HostsassociatedwithSpamfilteringlookupsalsohadahighernumberofre-verseresolutions.Thiscanbeexplainedbytheforward-confirmedreverseDNSmethodforverifyingassocia-tionsbetweenIPaddressesanddomains.Othersourcesof.arpatrafficincludeloggingservicessuchasrsyslogandpacketcapturesoftwaresuchastcpdumpandwire-shark.5.4oflocaldatabasesusedbyanti-virustools,thetoolsshoulduseanauthenticationtechniqueresilienttomaninthemiddleattackssuchasrequiringDNSSEC.Anexampleofwhatthiswouldlooklikeis:e9e3f794b69c8707f724f47a48dbb3a7b492a55f6e0e42968c19a3f00f96.57ce.list.domain.tldwherethefirsttwolevelsofthedomainistheSHA256orotherhash,andtherestofthelevelsdenotetheparentdomainofthedatabase.Anyhashlongerthan63characterswillneedtobesplitacrossdomainlevelsbecauseofthelimitintheDNSstandard[22].Themaximumlengthdomainnameis253characterswhichhasasizeof255databyteswhenrepresentedinaDNSpacket.SimilartotheSpamlists,thenumberofDNSerrorresponsesfromanti-viruslistswashigherforwiredhoststhanWi-Fihosts,buttheratiosvariedfrom1.3to5.8times.WetookthepositiveresultsfromURIblacklistsandcrosscheckedtoseeifhostsfromotherIPaddresseswererequestingblacklisteddomains.Wedidfindhostsac-cessingdomainslistedontheURIblacklists.InmanycasesthisisbecausethedomainsareforwidelyusedserviceswhichSpamemailslinkto,butwhichhostslegitimatecontentorprovidesalegitimateservice(ex-amples:TinyURL,YouTube,etc).ThepercentagesofblacklistedsuccessfulDNSresponsesforeachdatasetis3.79%,0.08%,0.10%,and0.20%.ThosehostswhichqueriedSpamrelatedblacklistshadamuchhigherpercentageofthenonclassifieddo-mains.Manynonexistentdomainsrequestedbythesehostshadarandomcomponentalongwithavalidpar-entdomain.WebelievetheserequestsweregeneratedasaresultofSpamfiltersperformingforward-confirmedreverseDNSchecking.Forward-confirmedreverseDNSiswhenthereisagreementbetweenthereversereso-lutionandtheforwardresolutionofadomainname.SpammerslikelyusefakesubdomainsofvaliddomainstotrytoevadeSpamfiltersbytakingadvantageofSpamexceptionfilters.Emailswhichclaimtooriginatefromaninvaliddomainorthatdonotpasstheforward-confirmedreverseDNScheckaremoresuspiciousthanoneswhichoriginatefromavaliddomain.Itisnote-worthythatifspammersrandomizetheoriginofandURIscontainedwithintheiremails,aSpamemailmaygenerateasignificantnumberofDNSqueries.Weob-servedcaseswhereoneURLwascheckedagainstthreeseparateblacklists.UsingDNSblacklistsforasafebrowsingbywarningauserwhentheyvisitanIPknowntohostexploitscanamplifytheamountofDNStrafficmadeforvisitingasinglepage.BlacklistsandWhitelistsBlacklistsandwhitelistsoverDNSleveragethein-frastructureofDNStoprovidecachedlookupstody-namicallychanginginformation.SomeSpamdetectionsolutionsrelyonDNSlookupstodetermine:Ifthesenderofanemailisblacklisted.IftheIPaddressoftheserverwhichtheemailwasoriginallysubmittedtoreverseresolvestothedomainoftheemailaddressinthefromfieldIfthereareblacklistedURLsinthecontentsofthemessageIPaddressesmaybeblacklistedforanumberofrea-sonssuchasbeingaknownsourceofSpam.SpamtrapsareonewayIPaddressesofSpamsendersareidenti-fied.Thereareblacklistsforopenproxyservers(HTTP,SOCKS,SMTP)whichmaybeusedbySpammerstohidetheIPaddressSpamoriginatesfrom.Someblack-listscontainIPaddressesformachineshostingexploits.Thesecanbedetectedbyspecializedwebcrawlers.TherearealsoblacklistsforIPaddressesexhibitingbehaviorassociatedwithbeingpartofabotnet.TheseIPad-dressescanbeidentifiedbylisteningforattackswithahoneypot.Lastly,thereareblacklistsforIPaddressrangeswhicharenotregistered,bogons,sincethereshouldnotbeemailsoriginatingfromtheseaddresses.Thisclassoftraffichasalargeratiooferrorresponsestoresponseswithnoerrorbecauseoflookupswhicharenotlisted.Spamrelatedblackandwhitelistsmadeupatleast5.34%to6.30%oftheDNSerrorresponses,andanti-virusrelatedlistsmadeupatleast1.71%to4.30%.WeobservedthatemailserversgenerateasignificantamountoftheSpamrelatedblackorwhitelisttraffic.Thisexplainswhyin3outofthe4datasets,thewiredhostshavemorethan2.8timesthepercentageofSpamlistDNSerrorresponsesthanWi-Fihosts.Someanti-virustoolsusehashbasedDNSlists.Ex-amplesincludeMcAfeeandSophos.Itshouldbenotedthatalthoughthismayallowforareductioninthesize5.5ApplicationBehaviorandBugsWeobserveddistinguishingfeaturesinsomeoftheDNSErrorresponses.Onecategoryofnonexistentdo-10
nexistentdo-10
mainrequestsweobservedhadtheprefix,https://orotherprotocolprefixessuchashttp://.TheseprefixesshouldntoccurinDNSrequestsandindicatethepres-enceofbuggyapplications.However,wedidfindexam-plesofvalidDNSresponsesfordomainsofthisformat.Thesedomainswerelikelyregisteredasaworkaround.Someapplicationbugsincludedaportspecificationinthedomainnamelookupsomething.com:8080,includedtherelativepath,ortheentireURI.Allofthesere-questsresultedinerrors.Javascriptbugswhichap-pendedanundefinedvariabletoadomainnamesome-thing.comundefinedorsomething.comnull.Therewerealsocaseswherelookupswereperformedforstringsthatwerelikelyfilenamesbecausetheyendedwithcommonfileextensions(e.g.index.html,image.jpg,script.js).Asimplemistakeonawebpagesuchas:to127.0.53.53.Since,Augustof2014thisaddresshasbeenpurposedforICANNnamecollisionmanagement.Table5showsthenumberofuniquedomainsreturning127.0.53.53versusthetotalnumberofrequestsforadomainnamewithonlyatoplevelwhichreturnedanIPaddress.Dataset1wastakeninJuneandpredatestherolloutofthisfeatureexplainingthelowernumbers.Dataset2hadalargeamountofrequeststoapartic-ularsecondleveldomainreturning127.0.53.53.Theserequestswerepresentindatasets1,and4butwereallnonexistentdomains.Oneobservationwemadewasqueriesrequestingran-domtopleveldomains.ThesourceofthesequerieswasfoundtobetheGoogleChromewebbrowser[35].SomeInternetserviceproviders(ISPs)hijackDNSresponsesandComcasthassubmittedanInternetdraftonDNSredirection[30].Althoughthistechniquemightbeused<iframesrc="http://index.html"></iframe> tedirection [30]. Although this technique might be used
<iframe src="http://index.html"></iframe> toofferservices,ICANNhasforbiddenNXDOMAIN<iframe src="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<iframe src="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<iframe src="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<imrame src="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<imgame src="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<imgme src="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img se src="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img srsrc="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img srcsrc="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src=rc="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="c="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="h="http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="ht"http://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="htthttp://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="httpttp://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http:tp://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http:/p://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://://index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://i//index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://im/index.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://imaindex.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://imagndex.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://imagedex.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://image.ex.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://image.jx.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://image.jp.html"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://image.jpghtml"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://image.jpg"tml"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://image.jpg"ml"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://image.jpg" /l"></iframe> to offer services, ICANN has forbidden NXDOMAIN
<img src="http://image.jpg" />substitutionbygTLDregistrarsforseveralreasonsin-<scriptsrc="http://script.js"></script>cludingbutnotlimitedtoprivacyanduserexperienceconcerns.ProperlydeterminingwhetherdomainsexistLoadingtheseHTMLtagsfromawebpageresultsinisadependencyofsomeofthebrowsersfeatures.TheaDNSqueryforindex.html,image.jpg,andscript.js,GoogleChromewebbrowserissuesdomainrequestsforrespectively.InsteadofaDNSquerythepagewriterseveralstringsofrandomletterstodetectDNShijack-likelyintendedtomakeHTTPrequestswhichwouldei-ing.TheserandomstringsareeffectivelyrandomTLDstherincludethedomainnamealongwiththepathorwhichdonotexist.WhenanISPhijacksnonexistentleavetheprotocoloutoftheURIentirely.Somedo-domainresponses,anaddressrecordtoanISPsearchmainlookupshadspaces,commasorasterisks.Intheseengineisreturnedinsteadoftheerrorresponse.ThecasesthelookupsappearedtoberelatedtoimproperlyChromewebbrowsercheckstoseeiftherandomqueriesconfiguredservers.itissuedresultinanaddressrecordinsteadofnonexis-SomedomainlookupscontainedURLencodedstringstentdomainresponses.Iftheserequestsaredirectedtosuchas%20.TheseencodingsallowspecialcharactersthesameIPaddress,itisclearthatIPaddressshouldbetobeincludedinPOSTandGETdatausedinHTTPinterpretedasannon-existentdomainresponse.With-lookups.Theseareusedheavilyinwebapplicationsoutthisdetectiontheaddressbarsearchfeaturewouldwhereusersubmittedcontentorqueriesaresubmittednotworkproperly.Thesedomainsaredistinguishabletotheweb-server.IfabuggywebapplicationneglectsfrombotnetC&CtrafficbecausebotnetshavenotusedtodelimittheURLpathfromthedomain,thesechar-TLDsastheirC&Cdomains.Atfirstglancethislooksacterscanendupinaquery.Alsoifausersbrowserlikeacategoryoftrafficattackerscouldhidetheirre-searchesfromtheaddressbar,theirsearchquerymaybequestsin;however,itisnttrivialtocreateanewtopinterpretedasadomainnameandinsteadofasearchleveldomainastheregistrationprocessoccursoveraparameter.Forapplications,thesebugstriggeredre-severalmonthperiod.Onedisadvantageofusingran-peatfailedqueries.Bugswhichshowupinclient-sidedomTLDsfordetectionisthepossibilitythatDNShi-JavaScriptmayonlyshowupforcertainversionsofcer-jackerslikeISPsmayleaveTLDsuntouchedandhijacktainbrowsersorundercertaincircumstanceslimitingsecondleveldomainsandgreater.Thistrafficonsometherateatwhichtheyarerepeated.Bugsinmobilesystemscausesrequestsforsubdomainsofthedomainapplicationsmaytriggerlookupsperiodically.ahostsbelongsto(seesubsection5.1).Wefoundanotherclassofnon-existentdomainqueriesDataset1234generatedbytheGoogleChromeweb-browser.Specifi-Numberofblockeddomains177245427callythisbrowserhasaDNSprefetchingfeaturewhichNumberofblockedTLDs024739isenabledbydefault.ThisclassoftrafficwasobservedTLDswithanyDNSrecord420354132335in[17]andisdiscussedin[11].ThisisdifferentthanHTML5prefetchingwhichrequestsdomainsforlinksTable5:ICANNNameCollisionBlockListStatsonapagethathave:IninvestigatingtopleveldomainswhichwerecomingbackashavingIPaddresseswefoundsomewithrecords<linkrel="dns-prefetch"href="//www.domain.tld/"/>11
dns-prefetch"href="//www.domain.tld/"/>11
Whenauseristypingadomainintheaddressbarandthequeryappearstobevalid,thisbrowserwillissueapreemptiveDNSrequest.PartialqueriesthatappeartobevalidendwithavalidTLD.ThisfeaturereducestheperceiveddelayofloadingapagetotheuseratacostofextraDNStraffic.Somearguethisraisesprivacyissuesbecauseitgeneratestrafficevenbeforetheuserhasactuallysubmittedasearchqueryorpagelookup.TherewereDNSlookupsforvalidIPv4andIPv6ad-dresses.Theseshouldhavebeenuseddirectlyasthedestinationaddressofaservice.RequestsofthisformmayoriginatewhenanapplicationissuesaDNSqueryforauserspecifiedfieldwithoutcheckingifitisanIPaddress.Thegethostname()libraryfunctiondoesnothavethisissue.Weobservedsomedomainswhichappearedtobein-tentionallyusedtogetnonexistentdomainresponses.Thesehadthelastleveldomainnone.5.6numberofnonexistentdomainresponsesbeingissuedbytheDNSserverfortheentirecampus.Theaveragebandwidthoftherequestsandresponseswaslessthan1Mbpswhichisnotcloseenoughtothelinkcapacitytocausecongestionbyitself.WedidobservefastfluxingDNSresponses,andsus-piciousDNStrafficlikelyrelatedtobotnets.SomeofthesuspicioustrafficappearedtobeaggregatedeitherbyNAToraDNSforwarder.OfthedomainswithDNSfailures89.11%to99.53%ofthemhadaneditdistancegreaterthantwotothenearestvaliddomain.There-mainingpercentageincludesthosetyposwhereinoneortwoinstancesaletterisomitted,different,orinserted.Examplesofdomainsweidentifiedwhichindicatethepresenceofmalwareinclude:bvkaymxoioe.www.game499.com.2014-12-30.pwbvkcrzkdcsb.www.gannme499.comloooplollokp80.commusechizewrt40.no-ip.infoENUMForVOIPOnesourceofalargevolumeofnonexistentdomainswasthenrenum.netsecondleveldomain.Nrenumpro-videsanENUMdatabaseoverDNSforparticipatinguniversities.ENUMprovidesawayforE.164numberstobeconvertedtoaURI[6].ProtocolssuchasSIPandH.323thenprovideawayofinitiatingthevoicecommunication.99.98%ofthenonexistentENUMdo-mainresponseswereforasinglehost.InDataset4foreverysuccessfullookupthishosthad9.67failures,butthenextmostcommonrequesterhadmorethan350successfullookupsforeveryfailure.ThisappearstobeabruteforcesearchoftheentireENUMdatabase.Theresultsofthiskindofsearchcouldbeusedtoasso-ciateIPaddresseswithVOIPphonenumbers,ordeter-minewhatnumbersareactiveforpurposeslikerobo-callers,etc.Onetechniquetomitigatethiskindofat-tackisimposeratelimitingperIPbythenumberofuniqueENUMsrequestedwithahigherpenaltyfornon-existentnumbers.Heavyoffenderscouldbeblacklisted,andlegitimateserviceswhichrequirehigherratescouldbewhite-listed.5.7Witheachexampletheboldpartofthedomainnamewasconstantwhiletherestofthedomainhadvariation.Thelasttwoexampleswereaccompaniedbyseveralre-queststothesameprefixwithdifferentnumbersattheend.Thisisanattempttolowertheeditdistancebe-tweenrequestsandavoiddetection.ThelastrequestwasforaDDNSprovider.6.CONCLUSIONHowtheInternetisusedandwhatservicesareof-feredhavechangedrapidlywiththeintroductionofnewtechnology.DNSisacriticalserviceenablingtheInter-nettofunction.WecollectedDNStrafficfromacam-pusoverseveraldaysdistinguishingwirelessfromwiredtraffic.Wehaveinvestigatednetworksources,applica-tionsources,andsourcesofNXDOMAINresponses,toprovideinsightintohowtheusageoftheDNSserviceischanging.Also,wecomparedDNSusagebetweenwiredandWi-Fihosts.Thewirelesshostswererespon-sibleforclosetotwothirdsoftheDNStraffic.MostofthepopulardomainsreceivedmoreDNSrequestsfromwirelessdevices.AsignificantamountofNXDOMAINresponsesweremeasured(10-15%),manyofwhichwererequestedbyapplicationswhichuseDNSasasidechan-nelthroughnetworkfirewalls.Thisincreaseinfailuresmakesitmoredifficulttoidentifymalicioustraffic.DNStrafficanalysishasprovedusefulinidentifyingseveralanomaliesandinfectedmachinesonthenetwork.SuspiciousandUnclassifiedTrafficInFigure4thereareseveralspikesintherateoferrorresponses.Wefoundthesetobecausedbyindividualhostswhichrepeatedlyqueriedparticularnon-existentdomainsrepeatedly.TheDNScacheexpirationtimeswerelargerthanthewidthofthespike,andthesere-sponseswereansweredfromthelocalDNSresolverscacheratherthangeneratingalargevolumeofDNSre-queststotheSOAforthesedomains.IftheseresponsesresultedinrequeststotheSOA,theywouldbedenialofservicetraffic,buttheonesweobservedweretheresultofasoftwarebugormisconfiguration.Onebugononemachinecausedamorethanten-foldincreaseinthe7.ACKNOWLEDGMENTSThispublicationwasmadepossiblebytheNPRPaward[NPRP5-648-2-264]fromtheQatarNationalRe-searchFund.12
12
8.REFERENCES[13]G.Huston.ManagementGuidelines&OperationalRequirementsfortheAddressandRoutingParameterAreaDomain(arpa).RFC3172(BestCurrentPractice),Sept.2001.[14]G.Huston.Deprecationofip6.int.RFC4159(BestCurrentPractice),Aug.2005.[15]J.Jung,E.Sit,H.Balakrishnan,andR.Morris.Dnsperformanceandtheeffectivenessofcaching.IEEE/ACMTrans.Netw.,10(5):589603,Oct.2002.[16]Y.Kazato,K.Fukuda,andT.Sugawara.TowardsclassificationofDNSerroneousqueries.InProceedingsofthe9thAsianInternetEngineeringConference,AINTEC13,pages2532,NewYork,NY,USA,2013.ACM.[17]S.KrishnanandF.Monrose.DNSprefetchinganditsprivacyimplications:Whengoodthingsgobad.InProceedingsofthe3rdUSENIXConferenceonLarge-scaleExploitsandEmergentThreats:Botnets,Spyware,Worms,andMore,LEET10,pages1010,Berkeley,CA,USA,2010.USENIXAssociation.[18]D.LeonardandD.Loguinov.Turboking:Frameworkforlarge-scaleinternetdelaymeasurements.InINFOCOM2008.27thIEEEInternationalConferenceonComputerCommunications,JointConferenceoftheIEEEComputerandCommunicationsSocieties,13-18April2008,Phoenix,AZ,USA,pages3135,2008.[19]E.Marcotte.ResponsiveWebDesign.http://alistapart.com/article/responsive-web-design.[20]T.Matsunaka,A.Yamada,andA.Kubota.PassiveOSfingerprintingbyDNStrafficanalysis.InProceedingsofthe2013IEEE27thInternationalConferenceonAdvancedInformationNetworkingandApplications,AINA13,pages243250,Washington,DC,USA,2013.IEEEComputerSociety.[21]P.Mockapetris.Domainnames-conceptsandfacilities.RFC1034(INTERNETSTANDARD),Nov.1987.[22]P.Mockapetris.Domainnames-implementationandspecification.RFC1035(INTERNETSTANDARD),Nov.1987.[23]J.S.Otto,M.A.Snchez,J.P.Rula,andF.E.Bustamante.Contentdeliveryandthenaturalevolutionofdns-remotednstrends,performanceissuesandalternativesolutions.Proc.ofInternetMeasurementConf.,Nov.2012.[24]M.D.P.Gauthier,J.CohenandC.Perkins.WebProxyAuto-DiscoveryProtocol.IETFInternetDraftworkinprogress00,IETF,November2000.[1]AlexaInternet,Inc.Thetop500sitesontheweb.http://www.alexa.com/topsites.[2]M.Antonakakis,R.Perdisci,W.Lee,N.Vasiloglou,II,andD.Dagon.DetectingmalwaredomainsattheupperDNShierarchy.InProceedingsofthe20thUSENIXConferenceonSecurity,SEC11,pages2727,Berkeley,CA,USA,2011.USENIXAssociation.[3]M.Antonakakis,R.Perdisci,Y.Nadji,N.Vasiloglou,S.Abu-Nimeh,W.Lee,andD.Dagon.Fromthrow-awaytraffictobots:DetectingtheriseofDGA-basedmalware.InProceedingsofthe21stUSENIXConferenceonSecuritySymposium,Security12,pages2424,Berkeley,CA,USA,2012.USENIXAssociation.[4]AppleInc.MacOSX:AboutMulticastDNS.https://support.apple.com/kb/TA20999?locale=enUS.[5]L.Bilge,S.Sen,D.Balzarotti,E.Kirda,andC.Kruegel.Exposure:ApassiveDNSanalysisservicetodetectandreportmaliciousdomains.ACMTrans.Inf.Syst.Secur.,16(4):14:114:28,Apr.2014.[6]S.Bradner,L.Conroy,andK.Fujiwara.TheE.164toUniformResourceIdentifiers(URI)DynamicDelegationDiscoverySystem(DDDS)Application(ENUM).RFC6116(ProposedStandard),Mar.2011.[7]N.Brownlee,K.Claffy,andE.Nemeth.DNSmeasurementsatarootserver.InGlobalTelecommunicationsConference,2001.GLOBECOM01.IEEE,volume3,pages16721676vol.3,2001.[8]S.CheshireandM.Krochmal.DNS-BasedServiceDiscovery.RFC6763(ProposedStandard),Feb.2013.[9]H.Falaki,R.Mahajan,S.Kandula,D.Lymberopoulos,R.Govindan,andD.Estrin.Diversityinsmartphoneusage.InProceedingsofthe8thInternationalConferenceonMobileSystems,Applications,andServices,MobiSys10,pages179194,NewYork,NY,USA,2010.ACM.[10]H.Gao,V.Yegneswaran,Y.Chen,P.Porras,S.Ghosh,J.Jiang,andH.Duan.Anempiricalreexaminationofglobaldnsbehavior.Proc.ofACMSIGCOMM,Aug.2013.[11]GoogleInc.DNSPrefetching.http://www.chromium.org/developers/design-documents/dns-prefetching.[12]S.Hao,M.Thomas,V.Paxson,N.Feamster,C.Kreibich,C.Grier,andS.Hollenbeck.Understandingthedomainregistrationbehaviorofspammers.Proc.ofInternetMeasurementConf.,Oct.2013.13
ionbehaviorofspammers.Proc.ofInternetMeasurementConf.,Oct.2013.13
[25]A.Pashalidis.Acautionarynoteonautomaticproxyconfiguration.InProceedingsoftheIASTEDInternationalConferenceonCommunication,Network,andInformationSecurity,CNIS,2003.[26]V.Paxson,M.Christodorescu,M.Javed,J.Rao,R.Sailer,D.Schales,M.P.Stoecklin,K.Thomas,W.Venema,andN.Weaver.PracticalcomprehensiveboundsonsurreptitiouscommunicationoverDNS.InProceedingsofthe22ndUSENIXConferenceonSecurity,SEC13,pages1732,Berkeley,CA,USA,2013.USENIXAssociation.[27]J.RulaandF.Bustamante.Behindthecurtaincellulardnsandcontentreplicaselection.Proc.ofInternetMeasurementConf.,Nov.2014.[28]K.Schomp,T.Callahan,M.Rabinovich,andM.Allman.Onmeasuringtheclient-sideDNSinfrastructure.InProceedingsofthe2013ConferenceonInternetMeasurementConference,IMC13,pages7790,NewYork,NY,USA,2013.ACM.[29]A.-J.Su,D.R.Choffnes,A.Kuzmanovic,andF.E.Bustamante.Draftingbehindakamai(travelocity-baseddetouring).Proc.ofACMSIGCOMM,2006.[30]J.L.T.Creighton,C.GriffithsandR.Weber.RecommendedConfigurationandUseofDNSRedirectbyServiceProviders.IETFInternetDraftworkinprogress00,IETF,July2009.[31]R.Villamarin-SalomonandJ.Brustoloni.IdentifyingbotnetsusinganomalydetectiontechniquesappliedtoDNStraffic.InConsumerCommunicationsandNetworkingConference,2008.CCNC2008.5thIEEE,pages476481,Jan2008.[32]S.Yadav,A.K.K.Reddy,A.L.N.Reddy,andS.Ranjan.Detectingalgorithmicallygenerateddomain-fluxattackswithDNStrafficanalysis.IEEE/ACMTrans.Netw.,20(5):16631677,Oct.2012.[33]S.Yadav,A.K.K.Reddy,A.N.Reddy,andS.Ranjan.Detectingalgorithmicallygeneratedmaliciousdomainnames.InProceedingsofthe10thACMSIGCOMMConferenceonInternetMeasurement,IMC10,pages4861,NewYork,NY,USA,2010.ACM.[34]S.YadavandA.L.N.Reddy.WinningwithDNSfailures:Strategiesforfasterbotnetdetection.In7thInternationalICSTConferenceonSecurityandPrivacyinCommunicationNetworks(SecureComm),London,UnitedKingdom,Sept.2011.[35]B.Zdrnja.GoogleChromeand(weird)DNSrequests.https://isc.sans.edu/diary/Google+Chrome+and+%28weird%29+DNS+requests/10312.14
eird%29+DNS+requests/10312.14
